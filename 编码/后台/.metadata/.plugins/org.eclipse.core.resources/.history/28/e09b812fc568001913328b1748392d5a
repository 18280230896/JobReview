package com.llg.listener;

import java.io.File;
import java.util.List;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

import org.dom4j.Document;
import org.dom4j.Element;
import org.dom4j.io.SAXReader;

import com.llg.util.FileUtil;

public class MyServletContentListener implements ServletContextListener {

	@Override
	public void contextDestroyed(ServletContextEvent arg0) {
		
	}

	@Override
	public void contextInitialized(ServletContextEvent arg0) {
		System.out.println("解析开始了");
		//解析path.xml
		SAXReader saxReader = new SAXReader(true);
		try {
			saxReader.setFeature("http://apache.org/xml/features/validation/schema", true);
			saxReader.setProperty("http://apache.org/xml/properties/schema/external-schemaLocation","http://www.example.org/path path.xsd");
			Document document = saxReader.read(new File("src/path.xml"));
			Element root = document.getRootElement();
			List<Element> elements = root.elements();
			for (Element element : elements) {
				if(element.getQName().equals("localJobPath")) FileUtil.LOCAL_JOB_PATH = element.getText();
				if(element.getQName().equals("localTempPath")) FileUtil.LOCAL_TEMP_PATH = element.getText();
				if(element.getQName().equals("virtualJobPath")) FileUtil.VIRTUAL_JOB_PATH = element.getText();
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

}
