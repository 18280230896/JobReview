$(".ul-info").mouseover(function(event){
	if(event.target.nodeName == "LI"){
		$(event.target).children(".option").fadeIn(150);
		$(event.target).siblings().children(".option").fadeOut(150);
	}
});

$(".ul-info").mouseleave(function(event){
	$(this).find(".option").fadeOut(150);
});

$(".panel-info").mouseover(function(){
	$(this).find(".add").fadeIn(150);
});
$(".panel-info").mouseleave(function(){
	$(this).find(".add").fadeOut(150);
});

//点击添加模块
var index = 1;
$("#addModuleBtn").click(function(){
	var newNode = $("<div class='form-group'>"+
						"<div class='input-group'>"+
							"<input type='text' class='form-control'></input>"+
							"<span class='input-group-btn'>"+
								"<button type='button' class='btn btn-default removeBtn'>"+
									"<span class='glyphicon glyphicon-remove removeBtn'>"+
								"</button>"+
							"</span>"+
							"</span>"+
						"</div> "+
						"<span class='help-block'></span>"+
					"</div>");
	newNode.hide();
	$("#addModuleModal .form-group").eq(0).after(newNode);
	newNode.slideDown(200);
});

//点击删除模块
$("#addModuleModal form").click(function(event){
	if($(event.target).hasClass("removeBtn")){
		var target;
		if(event.target.nodeName === "BUTTON"){
			target = $(event.target);
		}else if(event.target.nodeName === "SPAN"){
			target = $(event.target).parent();
		}
		target.parent().parent().parent().slideUp(200,function(){
			target.parent().parent().parent().remove();
		});
	}
});

/*////input内容改变事件
//$("#addTaskFileModal form").change(function(event){
//	if($(event.target).attr("type") == "file"){
//		//获取值
//		var v = $(event.target).val();
//		if(v != ""){
//			var arr = v.split("\\");
//			$(event.target).prev().text(arr[arr.length-1]);
//			$(event.target).parent().parent().parent().slideDown(200);
//		}else{
//			$(event.target).parent().parent().parent().remove();
//		}
//		
//	}	
//});
*/

//第一个input：1表示基本信息，2表示模块
//第二个input表示那个基本信息或模块id；

//点击修改基本信息按钮弹出修改框
$("#taskInfo .option").click(function(){
	var index = $(this).parent().index()
	$("#updateModal").modal("show");
	$("#updateModal .modal-footer input").eq(0).val(1);
	$("#updateModal .modal-footer input").eq(1).val(index);
	$("#updateModal .form-group").hide();
	$("#updateModal .form-group").eq(index).show();
	$("#updateModal .form-control").eq(index).val($(event.target).prev().text());
	if(index == 0) $("#updateModal .modal-title").text("修改任务名称");
	else if(index == 1) $("#updateModal .modal-title").text("修改任务类型");
});

//点击添加模块按钮弹出修改框
$("#moduleList .add").click(function(){
	$("#addModuleModal").modal("show");
});


$("#moduleList").click(function(event){
	//点击修改模块按钮弹出修改框
	if($(event.target).hasClass("update")){
		$("#updateModal").modal("show");
		$("#updateModal .modal-footer input").eq(0).val(2);
		$("#updateModal .modal-footer input").eq(1).val($(event.target).prev().prev().val());
		$("#updateModal .modal-title").text("修改模块名称");
		$("#updateModal .form-control").eq(2).val(task.subjects[$(event.target).parent().index()].name);
		$("#updateModal .form-group").hide();
		$("#updateModal .form-group").eq(2).show();
	}
	//点击删除按钮弹出确认框
	if($(event.target).hasClass("delete")){
		$("#dleModal").modal("show");
		$("#dleModal .modal-footer input").eq(0).val(1);
		$("#dleModal .modal-footer input").eq(1).val($(event.target).prev().prev().prev().val());
	}
});

//删除弹框第一个input:1代表删除模块，2代表删除附件
//第二个input：表示模块或附件id

//点击添加附件按钮弹出添加框
$("#fileList .add").click(function(){
	$("#addTaskFileModal").modal("show");
});

//点击删除文件按钮弹出确认框
$("#fileList").click(function(event){
	if($(event.target).hasClass("delete")){
		$("#dleModal").modal("show");
		$("#dleModal .modal-footer input").eq(0).val(2);
		$("#dleModal .modal-footer input").eq(1).val($(event.target).prev().prev().prev().val());
	}
	//点击下载文件
	if($(event.target).hasClass("download")){
		$(event.target).prev().children("span").click();
	}
});
